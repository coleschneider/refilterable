<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>re-filter demo</title>
  <style>
    div { border: 1px solid black; padding: 5px; }
  </style>
</head>
<body>
  <div id="app"></div>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script src="https://unpkg.com/react@16/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/history" crossorigin></script>
  <!-- <script src="https://unpkg.com/query-string@5.1.1"></script> -->
  <script src="/dist/re-filter.umd.js"></script>
  <script type="text/babel">
    const appEl = document.getElementById('app');
    const hist = History.createBrowserHistory();
    const { FiltersProvider, createFilter, useFilter } = reFilter;

    const pageFilter = createFilter('page', { 
      parse: (input) => parseInt(input), 
      format: (page) => String(page), 
      validate: (input, parse) => parse(input) >= 0,
      defaultValue: 0 
    });

    const lastClickFilter = createFilter('last-click', { 
      parse: (input) => new Date(Number(input)), 
      format: (date) => Number(date), 
      defaultValue: Date.now(),
    });

    function RenderCounter() {
      const count = React.useRef(1);

      return `Rendered ${count.current++} times`;
    }

    function LastClickTimeButton() {
      const [lastClick, setLastClick] = useFilter(lastClickFilter);

      return (
        <div>
          <RenderCounter />
          <br />
          Last Click: {lastClick.toString()}
          <br />
          <button onClick={() => setLastClick(Date.now())}>Update</button>
        </div>
      );
    }

    function PageButton({ pageNumber }) {
      const [page, setPage] = useFilter(pageFilter);

      // const reset = useReset(); // resets every registered filter to defaultValue or undefined


      return (
        <button onClick={() => setPage(pageNumber)}>
          {pageNumber}
        </button>
      )
    }

    function Pagination() {
      const [page] = useFilter(pageFilter);
      
      return (
        <div>
          <RenderCounter />
          <br />
          Current Page: {page}
          <br />
          <PageButton pageNumber={1} />
          <PageButton pageNumber={2} />
          <PageButton pageNumber={3} />
          <PageButton pageNumber={4} />
        </div>
      );
    }

    function App() {
      return (
        <FiltersProvider history={hist}>
          <RenderCounter />
          <Pagination />
          <LastClickTimeButton />
        </FiltersProvider>
      );
    }

    ReactDOM.render(<App />, appEl);
  
  
  </script>
</body>
</html>